<!doctype html>
<html lang="en">
<head>
<title>Frog Chat | Cisco</title>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<!--styles-->
<link rel="stylesheet" href="styles.css">
</head>
<body>
        <div id="container">
                <aside>
                    <header>
                        <input type="text" id="myInput" onkeyup="Search()" placeholder="search">
                    </header>
                    <ul id="myUL">
                        <li class="collection_item" id ="sony_chat" onclick="selectRecepient(this, 'Sony')">
                            <img src="https://source.unsplash.com/random/50x50" alt="">
                            <div>
                                <h2 class="collection_item_name">Sony</h2>
                                <h3>
                                    <span class="status orange"></span>
                                    offline
                                </h3>
                            </div>
                        </li>
                        <li class="collection_item" id = "fredo_chat" onclick="selectRecepient(this, 'Fredo')">
                            <img src="https://source.unsplash.com/random/50x50" alt="">
                            <div>
                                <h2 class="collection_item_name">Fredo</h2>
                                <h3>
                                    <span class="status green"></span>
                                    online
                                </h3>
                            </div>
                        </li>
                        <li class="collection_item" id = "michael_chat" onclick="selectRecepient(this, 'Michael')">
                            <img src="https://source.unsplash.com/random/50x50" alt="">
                            <div>
                                <h2 class="collection_item_name">Michael</h2>
                                <h3>
                                    <span class="status orange"></span>
                                    offline
                                </h3>
                            </div>
                        </li>
                        
                    </ul>
                </aside>
                <main>
                    <header>
                        <img src="https://s3-us-west-2.amazonaws.com/s.cdpn.io/1940306/chat_avatar_04.jpg" alt="">
                        <div>
                            <h2>Chat with Vito Croakleone</h2>
                        </div>
                    </header>
                    <ul id="chat">
                        
                    </ul>
                    <p id="demo"> </p>
                    <footer>
                        <textarea id="text_message" placeholder="Type your message"></textarea>
                        <button id="myBtn">Send</button>
                        
                    </footer>
                </main>
            </div>

            <script>
                function saveMessage() {
                   var message = document.getElementById("text_message").value;
                   document.getElementById("text_message").value = ""
                   //console.log(message)
                   var date = Date()
                   //console.log(date)
                   var message_box = `<li class="me">
                            <div class="entete">
                                <h3>`+date+`</h3>
                                <h2>Vito</h2>
                                <span class="status blue"></span>
                            </div>
                            <div class="triangle"></div>
                            <div class="message">
                                `+message+`
                            </div>
                        </li>`
                    //console.log(message_box)
                    var chat_history = sessionStorage.getItem(sessionStorage.getItem("current_recepient"))
                    sessionStorage.setItem(sessionStorage.getItem("current_recepient"), chat_history + message_box);
                    //console.log(sessionStorage.getItem("sony_chat"))
                    document.getElementById("chat").innerHTML=sessionStorage.getItem(sessionStorage.getItem("current_recepient"))
                }

                function selectRecepient(li, name) {
                    sessionStorage.setItem("current_recepient",li.id)
                    console.log(sessionStorage.getItem("current_recepient"))
                    document.getElementById("chat").innerHTML=sessionStorage.getItem(sessionStorage.getItem("current_recepient"))
                    //document.getElementById("fredo_chat").style.backgroundColor = "red";
                    var all_addressees = document.getElementsByClassName("collection_item")
                     var i;
                     for (i = 0; i < all_addressees.length; i++) {
                       all_addressees[i].style.backgroundColor = "#5e616a";
                     }
                     li.style.backgroundColor = "orangered";
                   
                }
                    
                    sessionStorage.setItem("current_recepient","sony_chat")
                    //sessionStorage.setItem("sony_chat","")
                    document.getElementById("myBtn").addEventListener("click", saveMessage);
                    //Search
                    function Search() {
                    var input, filter, ul, li, a, i, txtValue;
                    input = document.getElementById("myInput");
                     filter = input.value.toUpperCase();
                        ul = document.getElementById("myUL");
                     li = ul.getElementsByTagName("li");
                    for (i = 0; i < li.length; i++) {
                  a = li[i].getElementsByClassName("collection_item_name")[0];
                 txtValue = a.textContent || a.innerText;
                 if (txtValue.toUpperCase().indexOf(filter) > -1) {
               li[i].style.display = "";
             } else {
                  li[i].style.display = "none";
             }
        }
    }
                   

                
                    
            </script>
</body>
</html>